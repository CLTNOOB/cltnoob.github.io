<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>SimulaÃ§Ã£o de NegÃ³cios</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#fff}
header{text-align:center;padding:20px;background:rgba(0,0,0,.3)}
main{padding:25px;max-width:1200px;margin:auto}
.card{background:rgba(255,255,255,.08);border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 10px 30px rgba(0,0,0,.3)}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}
.stat{background:rgba(0,0,0,.35);padding:15px;border-radius:10px;text-align:center}
button{padding:12px;border:none;border-radius:8px;cursor:pointer;background:#00c6ff;font-weight:bold;width:100%;margin-top:10px}
button:hover{background:#00a8dd}
button:disabled{opacity:.55;cursor:not-allowed}
.hidden{display:none} 
.arrows{position:fixed;bottom:20px;right:20px;display:flex;flex-direction:column;gap:10px}
.arrow{width:50px;height:50px;border-radius:50%;font-size:20px}
#graph{height:200px;background:#000;margin-top:15px;position:relative;overflow:hidden}
.line{position:absolute;width:100%;height:2px;background:#00ff99;top:50%;transition:top .7s cubic-bezier(.2,.9,.2,1);will-change:top} 
</style>
</head>
<body>
<header>
<h1>ğŸ’¼ Simulador de NegÃ³cios</h1>
<p>Sistemas avanÃ§ados</p>
</header>
<main>

<div class="card" id="painelPrincipal">
<div class="stats">
<div class="stat">ğŸ’° Dinheiro<br><strong id="money">0</strong></div>
<div class="stat">ğŸ“ˆ Renda / clique<br><strong id="income">1</strong></div>
<div class="stat">ğŸ¢ NÃ­vel<br><strong id="level">1</strong></div>
<div class="stat">ğŸ¦ Renda Passiva<br><strong id="passive">0</strong></div>
</div>
<button onclick="ganharDinheiro()">Ganhar dinheiro</button>
<button onclick="upgrade()">Upgrade (custo <span id="upgradeCost">100</span>)</button>
<button onclick="abrir('investimentos')">Investimentos</button>
<button onclick="abrir('graficos')">GrÃ¡ficos</button>
<button onclick="abrir('loja')">Loja</button>
<button onclick="abrir('galeria')">Galeria</button>

<!-- Sistema de salvamento manual / export / import -->
<button onclick="salvar()">ğŸ’¾ Salvar (local)</button>
<button onclick="exportarSave()">â¬‡ï¸ Exportar Save</button>
<input id="importFile" class="hidden" type="file" accept="application/json" onchange="importarSave(event)">
<button onclick="document.getElementById('importFile').click()">â¬†ï¸ Importar Save</button>
<button onclick="apagarSave()">ğŸ—‘ï¸ Apagar Save</button>
</div>

<div class="card hidden" id="investimentos">
<h2>ğŸ¦ Investimentos</h2>
<div class="stat">ğŸ  Casa Alugada<br>Custo: 5.000<br>Retorno: +50 / 30s<button onclick="comprarInvestimento(5000,50)">Comprar</button></div>
<div class="stat" style="margin-top:10px">ğŸª Loja<br>Custo: 15.000<br>Retorno: +150 / 30s<button onclick="comprarInvestimento(15000,150)">Comprar</button></div>
<div class="stat" style="margin-top:10px">ğŸ¢ PrÃ©dio<br>Custo: 50.000<br>Retorno: +500 / 30s<button onclick="comprarInvestimento(50000,500)">Comprar</button></div>
<button onclick="voltar()">â¬… Voltar</button>
</div>

<div class="card hidden" id="graficos">
<h2>ğŸ“Š Mercado (alto risco)</h2>
<p>Escolha o valor e a direÃ§Ã£o</p>
<input id="valorInvest" type="number" placeholder="Valor para investir" style="width:100%;padding:10px;border-radius:6px;border:none">
<div id="graph"><div class="line" id="line"></div></div>
<div id="marketInfo" style="margin-top:8px">PreÃ§o: <strong id="marketPrice">50.0</strong> | Status: <span id="marketStatus">Pronto</span></div>
<div class="arrows"> 
<button class="arrow" onclick="investirGrafico('up')">â¬†</button>
<button class="arrow" onclick="investirGrafico('down')">â¬‡</button>
</div>
<div style="margin-top:10px">Resultado: <strong id="resultadoGrafico">0</strong></div>
<button onclick="voltar()">â¬… Voltar</button>
</div>

<div class="card hidden" id="loja">
<h2>ğŸ›’ Loja</h2>
<div class="stat">ğŸš— BMW<br>PreÃ§o: 120.000<button onclick="comprarVeiculo('BMW',120000)">Comprar</button></div>
<div class="stat" style="margin-top:10px">âœˆï¸ AviÃ£o<br>PreÃ§o: 1.000.000<button onclick="comprarVeiculo('AviÃ£o',1000000)">Comprar</button></div>
<button onclick="voltar()">â¬… Voltar</button>
</div>

<div class="card hidden" id="galeria">
<h2>ğŸ–¼ï¸ Galeria</h2>
<button onclick="mostrarGaleria('veiculos')">VeÃ­culos</button>
<button onclick="mostrarGaleria('casas')">Casas</button>
<div id="listaGaleria" style="margin-top:15px"></div>
<button onclick="voltar()">â¬… Voltar</button>
</div>

</main>
<script>
let dinheiro=0,renda=1,nivel=1,rendaPassiva=0,custoUpgrade=100;
let veiculosComprados=[],casasCompradas=[],isInvesting=false; 

function atualizar(){money.innerText=dinheiro;income.innerText=renda;level.innerText=nivel;passive.innerText=rendaPassiva;upgradeCost.innerText=custoUpgrade;salvar();}
function ganharDinheiro(){dinheiro+=renda;atualizar();}
function upgrade(){if(dinheiro>=custoUpgrade){dinheiro-=custoUpgrade;renda++;nivel++;custoUpgrade=Math.floor(custoUpgrade*1.2);atualizar();}else alert('Dinheiro insuficiente');}
function comprarInvestimento(c,r){if(dinheiro>=c){dinheiro-=c;rendaPassiva+=r;atualizar();}}
function comprarVeiculo(n,p){if(dinheiro>=p){dinheiro-=p;veiculosComprados.push({nome:n,preco:p});atualizar();}}
function abrir(id){painelPrincipal.classList.add('hidden');document.getElementById(id).classList.remove('hidden');}
function voltar(){document.querySelectorAll('.card').forEach(c=>c.classList.add('hidden'));painelPrincipal.classList.remove('hidden');}
function mostrarGaleria(t){let h='';if(t==='veiculos'){veiculosComprados.forEach(v=>h+=`ğŸš— ${v.nome} - ${v.preco}<br>`)}listaGaleria.innerHTML=h||'Nada comprado';}

function investirGrafico(dir){
  if(isInvesting) return;
  let v = Number(valorInvest.value);
  if(v<=0||v>dinheiro) return alert('Valor invÃ¡lido');
  isInvesting = true;
  // bloquear botÃµes enquanto a simulaÃ§Ã£o roda
  document.querySelectorAll('.arrow').forEach(b=>b.disabled=true);
  dinheiro -= v; // retira o valor apostado
  const duration = 3000; // ms
  const tick = 100; // ms
  const ticks = Math.floor(duration / tick);
  const startPrice = 50;
  let price = startPrice;
  marketStatus.innerText = 'Executando...';
  marketPrice.innerText = price.toFixed(1);
  let step = 0;
  const iv = setInterval(()=>{
    // bias em direÃ§Ã£o escolhida + ruÃ­do aleatÃ³rio
    const bias = (dir === 'up') ? (Math.random()*1.2 + 0.3) : -(Math.random()*1.2 + 0.3);
    const noise = (Math.random() - 0.5) * 1.2;
    price += bias + noise;
    price = Math.max(5, Math.min(95, price));
    marketPrice.innerText = price.toFixed(1);
    line.style.top = (100 - price) + '%';
    step++;
    if(step >= ticks){
      clearInterval(iv);
      // cÃ¡lculo de ganho: para 'up', lucro quando price > startPrice; para 'down' lucro quando price < startPrice
      const percentChange = (price - startPrice)/startPrice;
      const effectivePercent = (dir === 'up') ? percentChange : -percentChange;
      const ganho = Math.floor(v * effectivePercent);
      dinheiro += v + ganho; // devolve valor apostado + lucro (ou prejuÃ­zo se negativo)
      resultadoGrafico.innerText = ganho;
      marketStatus.innerText = ganho >= 0 ? 'Ganhou' : 'Perdeu';
      setTimeout(()=>{ marketStatus.innerText = 'Pronto'; }, 1200);
      document.querySelectorAll('.arrow').forEach(b=>b.disabled=false);
      isInvesting = false;
      atualizar();
    }
  }, tick);
}
setInterval(()=>{dinheiro+=rendaPassiva;atualizar();},30000);

function salvar(){localStorage.setItem('save',JSON.stringify({dinheiro,renda,nivel,rendaPassiva,custoUpgrade,veiculosComprados,casasCompradas}));}
function carregar(){let raw=localStorage.getItem('save');if(!raw)return;try{let s=JSON.parse(raw);dinheiro=s.dinheiro||0;renda=s.renda||1;nivel=s.nivel||1;rendaPassiva=s.rendaPassiva||0;custoUpgrade=s.custoUpgrade||100;veiculosComprados=s.veiculosComprados||[];casasCompradas=s.casasCompradas||[];}catch(e){console.warn('Save invÃ¡lido');}}
function exportarSave(){salvar();const data=localStorage.getItem('save');const blob=new Blob([data],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='sim_save.json';a.click();URL.revokeObjectURL(url);}
function importarSave(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=()=>{try{const s=JSON.parse(r.result);dinheiro=s.dinheiro||0;renda=s.renda||1;nivel=s.nivel||1;rendaPassiva=s.rendaPassiva||0;custoUpgrade=s.custoUpgrade||100;veiculosComprados=s.veiculosComprados||[];casasCompradas=s.casasCompradas||[];salvar();atualizar();alert('Save importado com sucesso!');}catch(err){alert('Arquivo invÃ¡lido');}};r.readAsText(f);e.target.value='';}
function apagarSave(){if(confirm('Apagar save?')){localStorage.removeItem('save');dinheiro=0;renda=1;nivel=1;rendaPassiva=0;custoUpgrade=100;veiculosComprados=[];casasCompradas=[];atualizar();alert('Save apagado');}}
carregar();atualizar();
</script>
</body>
</html>
